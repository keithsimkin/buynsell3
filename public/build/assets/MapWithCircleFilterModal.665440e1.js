import{aJ as E,bC as F,d as U,i as l,o as S,f as I,w as r,b as f,q as h,t as g,g as L,m as G,ae as H,a as V,r as u}from"./app.72d9fe45.js";import{A as R,O as T}from"./index.448b1588.js";import W from"./PsModal.49a87bcd.js";import j from"./PsButton.81d0ce1f.js";import q from"./PsLabel.dd7b9156.js";import{P as $}from"./PsUtils.eb7a8002.js";import{u as J}from"./AppInfoStore.3eac0301.js";import{A as K}from"./AppInfoParameterHolder.e24d894d.js";import{P as Q}from"./PsValueStore.46e374fe.js";import{P as X}from"./ps_constants.ea9d0b33.js";import{_ as Y}from"./plugin-vue_export-helper.21dcd24c.js";import"./vue-neat-modal.d239f4e3.js";import"./PsLine.c7f2ab42.js";import"./PsApiService.74841eb2.js";import"./PsObject.a17ef38f.js";import"./DefaultPhoto.cc755f93.js";const Z=E(()=>F(()=>import("./OpenStreetMap.2880bff3.js"),["assets/OpenStreetMap.2880bff3.js","assets/OpenStreetMap.6eb160be.css","assets/Control.Geocoder.310b1125.js","assets/Control.Geocoder.80a0276c.css","assets/app.72d9fe45.js","assets/app.1665158f.css","assets/plugin-vue_export-helper.21dcd24c.js"])),x=U({name:"MapWithCircleFilterModal",components:{PsModal:W,GoogleMap:R,Circle:T,PsButton:j,PsLabel:q,OpenStreetMap:Z},setup(){const e=l(),t=l(),a=l(),y=1610;let b;const c=l(),i=l(),s=l(1),o=l({position:{lat:40.876945,lng:77.387978},draggable:!0}),v=Q().getLoginUserId(),_=J(),m=new K;m.userId=v;const p=l({key:"000",center:o.value.position,zoom:15});async function C(){p.value.key=_.appInfo.data.frontendConfigSetting.mapKey}C();function k(){a.value!=null?(c.value=a.value.circle.component.value.getCenter().lat(),i.value=a.value.circle.component.value.getCenter().lng()):(c.value=o.value.position.lat,i.value=o.value.position.lng),b(c.value,i.value,s.value),e.value.toggle(!1)}function d(n,P,w,B){n!=0&&(o.value.position.lat=n),P!=0&&(o.value.position.lng=P),n!=0&&P!=0&&(p.value.center=o.value.position,t.value!=null&&t.value.center!=null&&(t.value.map.setCenter(t.value.map.center),a.value.circle.component.value.setCenter(o.value.position))),b=B,w!=0&&(s.value=w),e.value.toggle(!0)}function O(){a.value.circle.component.value.setRadius(s.value*y)}const D={editable:!1,center:o.value.position,radius:s.value*y,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,draggable:!0,crossOnDrag:!1};function A(n){c.value=n.latLng.lat(),i.value=n.latLng.lng()}function N(){a.value!=null&&($.log(a.value.circle.component.value.getRadius()),$.log(a.value.circle.component.value.getCenter().lat()+" <> "+a.value.circle.component.value.getCenter().lng()))}function z(n){o.value.position.lat=n.lat.toString(),o.value.position.lng=n.lng.toString()}return{psmodal:e,updateLeafletCoordinates:z,mcenter:o,map:p,openModal:d,map_ref:t,pickedLocation:k,cir_ref:a,circleCenter:D,radius_changed:N,dragend:A,radius:s,rangeChanged:O,appInfoStore:_,PsConst:X}}}),ee={class:"flex justify-between"};function oe(e,t,a,y,b,c){const i=u("ps-label"),s=u("Circle"),o=u("GoogleMap"),M=u("open-street-map"),v=u("ps-button"),_=u("ps-modal");return S(),I(_,{ref:"psmodal",line:"hidden",bodyHeight:"max-h-76",isClickOut:!0},{title:r(()=>[f(i,{class:"mb-2"},{default:r(()=>[h(g(e.$t("map_with_circle_filter_moadl__title")),1)]),_:1})]),body:r(()=>{var m,p,C,k;return[((p=(m=e.appInfoStore)==null?void 0:m.appInfo)==null?void 0:p.data.frontendConfigSetting.googleMap)==e.PsConst.ONE?(S(),I(o,{key:0,id:"map",ref:"map_ref","api-key":e.map.key,draggable:!0,center:e.map.center,zoom:e.map.zoom,style:{width:"100%",height:"300px"}},{default:r(()=>[f(s,{id:"circle",options:e.circleCenter,ref:"cir_ref",onDragend:e.dragend,onClick:e.radius_changed},null,8,["options","onDragend","onClick"])]),_:1},8,["api-key","center","zoom"])):L("",!0),((k=(C=e.appInfoStore)==null?void 0:C.appInfo)==null?void 0:k.data.frontendConfigSetting.openStreetMap)==e.PsConst.ONE?(S(),I(M,{key:1,dir:e.$page.props.dir,class:"h-68",lat:e.map.center.lat,lng:e.map.center.lng,dragValue:!1,onChange:e.updateLeafletCoordinates},null,8,["dir","lat","lng","onChange"])):L("",!0),f(i,{class:"mt-1"},{default:r(()=>[h(g(e.radius)+" "+g(e.$t("map_with_circle_filter_moadl__miles")),1)]),_:1}),G(V("input",{type:"range",id:"vol",name:"vol",min:"1",max:"300","onUpdate:modelValue":t[0]||(t[0]=d=>e.radius=d),onInput:t[1]||(t[1]=(...d)=>e.rangeChanged&&e.rangeChanged(...d)),class:"w-full"},null,544),[[H,e.radius]])]}),footer:r(()=>[V("div",ee,[f(v,{onClick:t[2]||(t[2]=m=>e.psmodal.toggle(!1)),class:"",theme:"btn-second"},{default:r(()=>[h(g(e.$t("map_with_circle_filter_moadl__cancel")),1)]),_:1}),f(v,{onClick:e.pickedLocation},{default:r(()=>[h(g(e.$t("map_with_circle_filter_moadl__pick_location")),1)]),_:1},8,["onClick"])])]),_:1},512)}var Ce=Y(x,[["render",oe]]);export{Ce as default};
